}
for(i in 1:nrow(vls)){
vsam[i,]  <- t(as.data.frame(vdf[i]))
}
vsam = matrix(0,0)
for(i in 1:nrow(vls)){
vsam[i,]  <- t(as.data.frame(vdf[i]))
}
vsam
vsam = matrix(0,0)
vsam
t(as.data.frame(vdf[i]))
vdf <- strsplit(vls, split = "-")
vdf
t(as.data.frame(vdf[i]))
vdf <- strsplit(vls, split = "-")
vdf[i]
vdf[i,]
vdf[,i]
vdf
vdf[i]
vdf[1]
vsam = matrix(0,0)
for(i in 1:nrow(vls)){
vsam[i]  <- t(as.data.frame(vdf[i]))
}
vsam = matrix(0,0)
for(i in 1:nrow(vls)){
vsam[i]  <- t(as.data.frame(vdf[i]))
}
vsam = matrix(0,0)
for(i in 1:nrow(vls)){
vsam  <- t(as.data.frame(vdf[i]))
}
t(as.data.frame(vdf[i]))
i=1
t(as.data.frame(vdf[i]))
vsam = matrix(0,0)
for(i in 1:nrow(vls)){
vsam[i,]  <- as.data.frame(t(as.data.frame(vdf[i])))
}
1:nrow(vls)
nrow(vls)
(vls)
vsam = matrix(0,0)
for(i in seq_along(vls)){
vsam[i,]  <- as.data.frame(t(as.data.frame(vdf[i])))
}
for(i in seq_along(vls)){
vsam[i]  <- as.data.frame(t(as.data.frame(vdf[i])))
}
vsam = matrix(0,0)
vdf <- strsplit(vls, split = "-")
vsam = matrix(0,0)
for(i in seq_along(vls)){
vsam[i]  <- as.data.frame(t(as.data.frame(vdf[i])))
}
vsam
vsam = matrix(0,0)
for(i in seq_along(vls)){
vsam[i,]  <- as.data.frame(t(as.data.frame(vdf[i])))
}
vsam = matrix(0,0)
for(i in seq_along(vls)){
vsam  <- as.data.frame(t(as.data.frame(vdf[i])))
}
vsam
i=1
as.data.frame(t(as.data.frame(vdf[i])))
vsam  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam
for(i in seq_along(vls)){
vsam  <- as.data.frame(t(as.data.frame(vdf[i])))
cbind(vsam, vsam)
}
vsam
vsam = matrix(0,0)
for(i in seq_along(vls)){
vsam  <- as.data.frame(t(as.data.frame(vdf[i])))
cbind(vsam, vsam)
}
vsam = matrix(0,0)
vsam = matrix(0,0)
vsam = matrix(0,0)
for(i in seq_along(vls)){
vsam  <- as.data.frame(t(as.data.frame(vdf[i])))
vres <-  cbind(vsam, vsam)
}
vres
vsam = matrix(0,0)
for(i in seq_along(vls)){
vsam  <- as.data.frame(t(as.data.frame(vdf[i])))
vres <-  cbind(vsam, vsam)
}
vsam = 0
for(i in seq_along(vls)){
vsam  <- as.data.frame(t(as.data.frame(vdf[i])))
vres <-  cbind(vsam, vsam)
}
vres
vsam = vls=0
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
virome <-  cbind(vres, vsam)
}
virome
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
virome <-  cbind(vres, vsam)
}
virome
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam <-  cbind(vres, vsam)
}
virome
vsam <-  c(cbind(vres, vsam))
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam <-  c(cbind(vres, vsam))
}
virome
vsam[1,] <-  cbind(vres, vsam)
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam[1,] <-  cbind(vres, vsam)
}
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam[i] <-  cbind(vres, vsam)
}
virome
vsam <-  cbind(vres, vsam)
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam <-  cbind(vres, vsam)
}
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam <-  cbind(vres, vsam)
}
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam <-  cbind(vres, vsam)
}
virome
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam <-  rbind(vres, vsam)
}
virome
vsam = vls=0
for (i in 1:nrow(mln_virome)){
obj <- paste(i, mln_virome[i,], sep="-")
vls <- c(unlist(obj), vls)
}
vls
vdf <- strsplit(vls, split = "-")
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam <-  rbind(vres, vsam)
}
virome
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam <-  rbind(vres, vsam)
}
vres
vsam
i=1
as.data.frame(t(as.data.frame(vdf[i])))
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vsam
vsam = vls=0
rbind(vres, vsam)
rbind(vres, vsam)
vsam <-  rbind(vres, vsam)
rbind(vres, vsam)
2=i
i=2
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vres
vsam <-  rbind(vres, vsam)
vsam
i=3
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
vres
rbind(vres, vsam)
rbind(vres, vsam)
vres
dim(vres)
ncol(vres)
vres
vres  == 1
if (vres, ncol(vres)  == 1)
if (vres, ncol(vres)  == 1, )
if (vres, ncol(vres)  == 1 )
if (ncol(vres)  == 1 )
, as.data.frame(0,0)
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
if (ncol(vres)  != 1 )
vsam <-  rbind(vres, vsam)
}
virome
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
if (ncol(vres)  != 1 )
vsam <-  rbind(vres, vsam)
}
virome
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
i=1
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
ncol(vres)
ncol(vres)  == 2
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
if (ncol(vres)  == 2 )
vsam <-  rbind(vres, vsam)
}
virome
i=1
as.data.frame(t(as.data.frame(vdf[i])))
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
if (ncol(vres)  == 2 ){
vsam <-  rbind(vres, vsam)
}
}
virome
i=1
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
if (ncol(vres)  == 2 ){
vsam <-  rbind(vres, vsam)
}
vsam
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
if (ncol(vres)  == 2 ){
vsam <-  rbind(vres, vsam)
}
}
vsam
rownames(vsam)
length(vsam)
rownames(vsam) <- 1:nrow(vsam)
vsam
seq_along(vls)
vsam = vls = 0
for (i in 1:nrow(mln_virome)){
obj <- paste(i, mln_virome[i,], sep="-")
vls <- c(unlist(obj), vls)
}
vls
vdf <- strsplit(vls, split = "-")
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
if (ncol(vres)  == 2 ){
vsam <-  rbind(vres, vsam)
}
}
rownames(vsam) <- 1:nrow(vsam)
vsam
meta <- read.csv("data/Virome_MLN_Kenya_hosts.txt")
meta
meta <- read.csv("data/Virome_MLN_Kenya_hosts.txt")
meta
mln_virome
#-- loading data
mln_virome <- read.csv("data/Virome_MLN_Kenya_species.csv")
mln_virome
dim(mln_virome)
vsam
#-- loading data
mln_virome <- read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt")
mln_virome
#-- loading data
mln_virome <- read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt")
mln_virome
dim(mln_virome)
m
mln_virome
as.list(mln_virome)
list(mln_virome)
#-- loading data
mln_virome <- read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt")
(mln_virome)
#-- loading data
mln_virome <- read.table("data/Virome_MLN_Kenya_species_Wamaitha18.txt")
(mln_virome)
#-- loading data
mln_virome <- read.table("data/Virome_MLN_Kenya_species_Wamaitha18.txt", header = F)
(mln_virome)
#-- loading data
mln_virome <- read.table("data/Virome_MLN_Kenya_species_Wamaitha18.txt", header = F, quote = ",")
(mln_virome)
#-- loading data
mln_virome <-read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt")
(mln_virome)
mln_virome
dim(mln_virome)
#-- loading data
mln_virome <-read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt")
mln_virome
dim(mln_virome)
#-- loading data
mln_virome <-read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt", header = F)
mln_virome
dim(mln_virome)
#-- loading data
mln_virome <-read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt", header = F)
mln_virome
dim(mln_virome)
#-- loading data
mln_virome <- read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt")
mln_virome
dim(mln_virome)
mln_virome
#-- loading data
mln_virome <- read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt")
mln_virome
#-- loading data
mln_virome <- read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt", sep = "\t")
mln_virome
#-- loading data
mln_virome <- read.csv("data/Virome_MLN_Kenya_species_Wamaitha18.txt", sep = "\t"
, header = F)
mln_virome
dim(mln_virome)
mln_virome
vsam = vls = 0
for (i in 1:nrow(mln_virome)){
obj <- paste(i, mln_virome[i,], sep="-")
vls <- c(unlist(obj), vls)
}
vls
mln_virome
vsam = vls = 0
for (i in 1:nrow(mln_virome)){
obj <- paste(mln_virome[i], mln_virome[i,], sep="-")
vls <- c(unlist(obj), vls)
}
vls
vsam = vls = 0
for (i in 1:nrow(mln_virome)){
obj <- paste(mln_virome[i], mln_virome[i,], sep="-")
vls <- c(unlist(obj), vls)
}
mln_virome[i]
mln_virome[i,1]
mln_virome[1, i]
mln_virome
mln_virome$V1[i]
vsam = vls = 0
for (i in 1:nrow(mln_virome)){
obj <- paste(mln_virome$V1[i], mln_virome[i,], sep="-")
vls <- c(unlist(obj), vls)
}
vls
vdf <- strsplit(vls, split = "-")
vdf
for(i in seq_along(vls)){
vres  <- as.data.frame(t(as.data.frame(vdf[i])))
if (ncol(vres)  == 2 ){
vsam <-  rbind(vres, vsam)
}
}
vsam
class(vsam$V2)
class(vsam$V1) == class(vsam$V2)
class(vsam$V1)
0 == class(vsam$V2)
class(vsam$V2)
apply(vsam, 2, *)
apply(vsam, 1, *)
apply(vsam, 1, mean)
apply(vsam, 2, mean)
vsam$rmcol <- "character" == class(vsam$V2)
vsam$rmcol
class(vsam$V2)
class(vsam$V1)
vsam
vsam$V2
vsam$rmcol <- as.numeric(vsam$V1) * as.numeric(vsam$V2)
vsam
is.na(vsam$rmcol)
!is.na(vsam$rmcol)
vsam[!is.na(vsam$rmcol),]
vsam$rmcol <- as.numeric(vsam$V1) * as.numeric(vsam$V2)
vsam[!is.na(vsam$rmcol)]
vsam[!is.na(vsam$rmcol),]
vsam[is.na(vsam$rmcol),]
rownames(vsam) <- 1:nrow(vsam)
vsam
vsam <- vsam[is.na(vsam$rmcol),]
rownames(vsam) <- 1:nrow(vsam)
vsam
#-----
library(ggplot2)
virome=vsam
ggplot(virome, aes(x=reorder(IDs, Family), y=log2(RPKM_mean), fill=Genus)) +
geom_bar(position="fill", stat="identity", width = 1, alpha = 0.75)+
ggtitle("Virome genus frequency by sweetpotato land area ") +
facet_grid(~cluster.y, scales = "free", space = "free") +
scale_fill_viridis(discrete = T, option = "C") +
scale_x_reordered() +
theme_bw()
#-----
library(ggplot2)
library(tidytext)
install.packages("tidytext")
# ViNA results data
virome <- read.csv("8-bipartite_networks/sweetpotato_virome_vsc-rpkmx_ViNAtq_Feb26_ed.csv", header = T, stringsAsFactors = F)[-1]
# ViNA results data
virome <- read.csv("/Users/ricardoi/Dropbox\ \(UFL\)/Alcala_Briseno-Garrett/+++Sweetpotato_virome/+Sweetpotato_virome/8-bipartite_networks/sweetpotato_virome_vsc-rpkmx_ViNAtq_Feb26_ed.csv", header = T, stringsAsFactors = F)[-1]
# ViNA results data
virome <- read.csv("~/Alcala_Briseno-Garrett/+++Sweetpotato_virome/+Sweetpotato_virome/8-bipartite_networks/sweetpotato_virome_vsc-rpkmx_ViNAtq_Feb26_ed.csv", header = T, stringsAsFactors = F)[-1]
virome
virome <- merge(virome, kclusters[c(2,8)],
by.x= "IDs", by.y= "SampleID")
as_tibble(virome)
View(virome)
kcluters <- read.csv("~/Alcala_Briseno-Garrett/+++Sweetpotato_virome/+Sweetpotato_virome/8-bipartite_networks/Aswp_rpkmx_clusters_res1ed-Nov9.csv", header = T, stringsAsFactors = F))
kcluters <- read.csv("~/Alcala_Briseno-Garrett/+++Sweetpotato_virome/+Sweetpotato_virome/8-bipartite_networks/Aswp_rpkmx_clusters_res1ed-Nov9.csv", header = T, stringsAsFactors = F)
kcluters
virome
head(virome)
kclusters <- read.csv("~/Alcala_Briseno-Garrett/+++Sweetpotato_virome/+Sweetpotato_virome/8-bipartite_networks/Aswp_rpkmx_clusters_res1ed-Nov9.csv", header = T, stringsAsFactors = F)
head(kclusters)
virome <- merge(virome, kclusters[c(2,8)],
by.x= "IDs", by.y= "SampleID")
virome <- merge(virome, kclusters[c(2,8)],
by= "IDs")
virome
as_tibble(virome)
ggplot(virome, aes(x=reorder(IDs, Family), y=log2(RPKM_mean), fill=Genus)) +
geom_bar(position="fill", stat="identity", width = 1, alpha = 0.75)+
ggtitle("Virome genus frequency by sweetpotato land area ") +
facet_grid(~cluster.y, scales = "free", space = "free") +
scale_fill_viridis(discrete = T, option = "C") +
scale_x_reordered() +
theme_bw()
# library
library(ggplot2)
library(tidytext)
ggplot(virome, aes(x=reorder(IDs, Family), y=log2(RPKM_mean), fill=Genus)) +
geom_bar(position="fill", stat="identity", width = 1, alpha = 0.75)+
ggtitle("Virome genus frequency by sweetpotato land area ") +
facet_grid(~cluster.y, scales = "free", space = "free") +
scale_fill_viridis(discrete = T, option = "C") +
scale_x_reordered() +
theme_bw()
library(viridis)
# library
library(ggplot2)
library(tidytext)
library(viridis)
library(viridis)
# ViNA results data
virome <- read.csv("~/Alcala_Briseno-Garrett/+++Sweetpotato_virome/+Sweetpotato_virome/8-bipartite_networks/sweetpotato_virome_vsc-rpkmx_ViNAtq_Feb26_ed.csv", header = T, stringsAsFactors = F)[-1]
kclusters <- read.csv("~/Alcala_Briseno-Garrett/+++Sweetpotato_virome/+Sweetpotato_virome/8-bipartite_networks/Aswp_rpkmx_clusters_res1ed-Nov9.csv", header = T, stringsAsFactors = F)
virome <- merge(virome, kclusters[c(2,8)],
by= "IDs")
as_tibble(virome)
ggplot(virome, aes(x=reorder(IDs, Family), y=log2(RPKM_mean), fill=Genus)) +
geom_bar(position="fill", stat="identity", width = 1, alpha = 0.75)+
ggtitle("Virome genus frequency by sweetpotato land area ") +
facet_grid(~cluster.y, scales = "free", space = "free") +
scale_fill_viridis(discrete = T, option = "C") +
scale_x_reordered() +
theme_bw()
# library
library(ggplot2)
library(tidytext)
library(viridis)
ggplot(virome, aes(x=reorder(IDs, Family), y=log2(RPKM_mean), fill=Genus)) +
geom_bar(position="fill", stat="identity", width = 1, alpha = 0.75)+
ggtitle("Virome genus frequency by sweetpotato land area ") +
facet_grid(~cluster.y, scales = "free", space = "free") +
scale_fill_viridis(discrete = T, option = "C") +
scale_x_reordered() +
theme_bw()
virome
kclusters[c(2,8)]
kclusters
virome
kclusters
virome <- merge(virome, kclusters[c(2,"cluster")],
by= "IDs")
dim(kclusters)
virome <- merge(virome, kclusters[c(2, 15)],
by= "IDs")
as_tibble(virome)
head(virome)
virome <- merge(virome, kclusters[c(2, 15)],
by= "IDs")
head(virome)
kclusters[c(2, 15)]
head(virome)
kclusters
virome <- merge(virome, kclusters[c(2, 15)],
by.x= "IDs", by.y = "IDs")
virome <- merge(virome, kclusters[c(2, 15)],
by.x= "IDs", by.y = "IDs")
çççç
virome <- merge(virome, kclusters[c(2, 15)],
by = "IDs")
virome <- merge(virome, kclusters[c(2, 15)],
by = "IDs")
R.version
